<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immobilien-Steuerrechner Deutschland</title>
    <link rel="stylesheet" href="immobilien-steuerrechner.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <h1>Immobilien-Steuerrechner Deutschland</h1>
    <p>Berechnen Sie Steuern, Kosten und Cashflow für Ihre Immobilieninvestition in Deutschland.</p>
    <div class="global-settings-bar">
        <div class="global-setting">
            <label for="calculation-period">Betrachtungszeitraum (Jahre):</label>
            <input type="number" id="calculation-period" value="10" min="1" max="50">
        </div>
        <button id="update-calculations" class="update-button">Berechnungen aktualisieren</button>
    </div>
    <div class="tab-container">
        <div class="tabs">
            <div class="tab active" data-tab="input">Immobiliendaten</div>
            <div class="tab" data-tab="tax">Steuerinformationen</div>
            <div class="tab" data-tab="overview">Übersichten</div>
            <div class="tab" data-tab="cashflow">Cashflow</div>
            <div class="tab" data-tab="yeartable">Jahrestabelle</div>
        </div>
        
        <!-- Tab 1: Eingabe aller Immobiliendaten -->
        <div id="input" class="tab-content active">
            <div class="container">
                <!-- Karte: Immobiliendaten -->
                <div class="card">
                    <h2>Immobiliendaten</h2>
                    <div class="form-group">
                        <label for="purchase-price">Kaufpreis (€)</label>
                        <input type="number" id="purchase-price" value="316500">
                    </div>
                    <div class="form-group">
                        <label for="bundesland">Bundesland</label>
                        <select id="bundesland">
                            <option value="3.5">Baden-Württemberg (3.5%)</option>
                            <option value="3.5">Bayern (3.5%)</option>
                            <option value="6.0">Berlin (6.0%)</option>
                            <option value="6.5">Brandenburg (6.5%)</option>
                            <option value="5.0">Bremen (5.0%)</option>
                            <option value="4.5">Hamburg (4.5%)</option>
                            <option value="6.0">Hessen (6.0%)</option>
                            <option value="5.0">Mecklenburg-Vorpommern (5.0%)</option>
                            <option value="5.0">Niedersachsen (5.0%)</option>
                            <option value="6.5">Nordrhein-Westfalen (6.5%)</option>
                            <option value="5.0">Rheinland-Pfalz (5.0%)</option>
                            <option value="6.5">Saarland (6.5%)</option>
                            <option value="3.5">Sachsen (3.5%)</option>
                            <option value="5.0">Sachsen-Anhalt (5.0%)</option>
                            <option value="6.5">Schleswig-Holstein (6.5%)</option>
                            <option value="6.5">Thüringen (6.5%)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notary-costs">Notarkosten (% vom Kaufpreis)
                            <span class="tooltip">?
                                <span class="tooltiptext">Üblicherweise 1,5-2% des Kaufpreises</span>
                            </span>
                        </label>
                        <input type="number" id="notary-costs" step="0.1" value="1.5">
                    </div>
                    <div class="form-group">
                        <label for="broker-fee">Maklerprovision (% vom Kaufpreis)
                            <span class="tooltip">?
                                <span class="tooltiptext">Seit 2020 müssen Käufer max. 50% der Provision zahlen</span>
                            </span>
                        </label>
                        <input type="number" id="broker-fee" step="0.1" value="3">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="broker-as-consulting" checked>
                            Maklerkosten als Beratungsleistung (sofortige Absetzung im 1. Jahr)
                            <span class="tooltip">?
                                <span class="tooltiptext">Bei entsprechender Vertragsgestaltung können Maklerleistungen ggf. als Beratungsleistung deklariert und sofort abgesetzt werden</span>
                            </span>
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="depreciation-rate">AfA-Satz (% p.a.)
                            <span class="tooltip">?
                                <span class="tooltiptext">Normalerweise 2% für Gebäude ab 2023</span>
                            </span>
                        </label>
                        <input type="number" id="depreciation-rate" step="0.1" value="2.0">
                    </div>
                </div>
                <!-- Karte: Kaufpreisaufteilung -->
                <div class="card">
                    <h2>Kaufpreisaufteilung</h2>
                    <div class="form-group">
                        <label for="land-value">Grundstücksanteil (€)
                            <span class="tooltip">?
                                <span class="tooltiptext">Wert des Grundstücks vom Gesamtkaufpreis</span>
                            </span>
                        </label>
                        <input type="number" id="land-value" value="45000">
                    </div>
                    <div class="form-group">
                        <label for="building-value">Gebäudeanteil (€)
                            <span class="tooltip">?
                                <span class="tooltiptext">Wert des Gebäudes vom Gesamtkaufpreis</span>
                            </span>
                        </label>
                        <input type="number" id="building-value" value="255000">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-cost">Erhaltungsaufwand (€)
                            <span class="tooltip">?
                                <span class="tooltiptext">Kosten für Sanierung/Renovierung nach dem Kauf</span>
                            </span>
                        </label>
                        <input type="number" id="maintenance-cost" value="35000">
                    </div>
                    <div class="form-group">
                        <label for="furniture-value">Kaufpreis Möbel (€)
                            <span class="tooltip">?
                                <span class="tooltiptext">Wert der mitgekauften Möbel und Einrichtung</span>
                            </span>
                        </label>
                        <input type="number" id="furniture-value" value="16500">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-distribution">Verteilung Erhaltungsaufwand
                            <span class="tooltip">?
                                <span class="tooltiptext">Der Erhaltungsaufwand kann auf 1-5 Jahre verteilt werden (einmalige Abschreibung)</span>
                            </span>
                        </label>
                        <select id="maintenance-distribution">
                            <option value="1">Im 1. Jahr voll absetzen</option>
                            <option value="2">Auf 2 Jahre verteilen</option>
                            <option value="3">Auf 3 Jahre verteilen</option>
                            <option value="4">Auf 4 Jahre verteilen</option>
                            <option value="5">Auf 5 Jahre verteilen</option>
                        </select>
                    </div>
                    <div class="form-group" id="price-validation-warning" style="color: red; display: none;">
                        Warnung: Die Summe der Kaufpreisaufteilung entspricht nicht dem Gesamtkaufpreis!
                    </div>
                </div>
                
                <!-- Karte: Finanzierung -->
                <div class="card">
                    <h2>Finanzierung</h2>
                    <div class="form-group">
                        <label for="financing-type">Finanzierungsart</label>
                        <select id="financing-type">
                            <option value="loan">Kredit</option>
                            <option value="cash">Eigenkapital</option>
                        </select>
                    </div>
                    <div id="loan-details">
                        <div class="form-group">
                            <label for="down-payment">Eigenkapital (€)</label>
                            <input type="number" id="down-payment" value="25000">
                        </div>
                        <div class="form-group">
                            <label for="interest-rate">Zinssatz (%)</label>
                            <input type="number" id="interest-rate" step="0.01" value="4.0">
                        </div>
                        <div class="form-group">
                            <label for="repayment-rate">Tilgungssatz (% p.a.)</label>
                            <input type="number" id="repayment-rate" step="0.1" value="1.5">
                        </div>
                    </div>
                </div>
                
                <!-- Karte: Vermietung und laufende Kosten -->
                <div class="card">
                    <h2>Vermietung und laufende Kosten</h2>
                    <div class="form-group">
                        <label for="rental-income">Monatliche Kaltmiete (€)</label>
                        <input type="number" id="rental-income" value="1200">
                    </div>
                    <div class="form-group">
                        <label for="vacancy-rate">Leerstandsquote (% p.a.)</label>
                        <input type="number" id="vacancy-rate" step="0.1" value="3.0">
                    </div>
                    <div class="form-group">
                        <label for="property-tax">Grundsteuer (€ p.a.)
                            <span class="tooltip">?
                                <span class="tooltiptext">Seit 2025 gilt das neue Grundsteuergesetz</span>
                            </span>
                        </label>
                        <input type="number" id="property-tax" value="500">
                    </div>
                    <div class="form-group">
                        <label for="management-fee">Hausverwaltung (€ p.a.)</label>
                        <input type="number" id="management-fee" value="600">
                    </div>
                    <div class="form-group">
                        <label for="maintenance-reserve">Instandhaltungsrücklage (€ p.a.)
                            <span class="tooltip">?
                                <span class="tooltiptext">Jährliche Rücklagen für zukünftige Instandhaltungsmaßnahmen</span>
                            </span>
                        </label>
                        <input type="number" id="maintenance-reserve" value="600">
                    </div>
                    <div class="form-group">
                        <label for="insurance">Versicherungen (€ p.a.)</label>
                        <input type="number" id="insurance" value="300">
                    </div>
                </div>
                
                <!-- Karte: Kapitalwert und Rendite -->
                <div class="card">
                    <h2>Kapitalwert und Rendite</h2>
                    <div class="form-group">
                        <label for="expected-appreciation">Jährliche Wertsteigerung (%)</label>
                        <input type="number" id="expected-appreciation" step="0.1" value="2.0">
                    </div>
                    <div class="form-group">
                        <label for="expected-rent-increase">Jährliche Mietsteigerung (%)</label>
                        <input type="number" id="expected-rent-increase" step="0.1" value="1.5">
                    </div>
                </div>
            </div>
            
            <!-- Berechnen-Button für alle Eingaben -->
            <div class="card calculation-button-container">
                <button id="calculate-all" class="primary-button">Alle Berechnungen durchführen</button>
            </div>
        </div>
        
        <!-- Tab 2: Übersichten zusammengefasst -->
        <div id="overview" class="tab-content">
            <div class="container">
                <!-- Karte: Kaufkosten & Steuern -->
                <div class="card">
                    <h2>Kaufkosten & Steuern</h2>
                    <div class="results" id="purchase-results">
                        <div class="result-item">
                            <div class="result-label">Kaufpreis</div>
                            <div class="result-value" id="result-purchase-price">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Grunderwerbsteuer</div>
                            <div class="result-value" id="result-grunderwerbsteuer">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Notarkosten</div>
                            <div class="result-value" id="result-notary">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Maklerprovision</div>
                            <div class="result-value" id="result-broker">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Gesamte Kaufnebenkosten</div>
                            <div class="result-value" id="result-total-extra">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Gesamtkosten</div>
                            <div class="result-value" id="result-total-cost">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Grundstücksanteil</div>
                            <div class="result-value" id="result-land-value">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Gebäudeanteil</div>
                            <div class="result-value" id="result-building-value">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Erhaltungsaufwand</div>
                            <div class="result-value" id="result-maintenance-cost">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Kaufpreis Möbel</div>
                            <div class="result-value" id="result-furniture-value">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Jährlicher Erhaltungsaufwand (steuerlich)</div>
                            <div class="result-value" id="result-annual-maintenance">0 €</div>
                        </div>
                    </div>
                </div>
                
                <!-- Karte: Jährliche Kosten & Einnahmen -->
                <div class="card">
                    <h2>Jährliche Kosten & Einnahmen</h2>
                    <div class="results" id="ongoing-results">
                        <div class="result-item">
                            <div class="result-label">Jährliche Mieteinnahmen (brutto)</div>
                            <div class="result-value" id="result-annual-rent">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Effektive Mieteinnahmen (nach Leerstand)</div>
                            <div class="result-value" id="result-effective-rent">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Grundsteuer</div>
                            <div class="result-value" id="result-property-tax">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Hausverwaltung</div>
                            <div class="result-value" id="result-management">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Instandhaltungsrücklage</div>
                            <div class="result-value" id="result-maintenance">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Versicherungen</div>
                            <div class="result-value" id="result-insurance">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Gesamte laufende Kosten</div>
                            <div class="result-value" id="result-total-ongoing">0 €</div>
                        </div>
                    </div>
                </div>
                <!-- Karte: Zusammenfassung -->
                <div class="card">
                    <h2>Zusammenfassung</h2>
                    <div class="results" id="summary-results">
                        <div class="result-item">
                            <div class="result-label">Kaufpreis inkl. Nebenkosten</div>
                            <div class="result-value" id="summary-total-cost">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Eigenkapital</div>
                            <div class="result-value" id="summary-equity">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Fremdkapital</div>
                            <div class="result-value" id="summary-loan">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Monatliche Belastung (Bank)</div>
                            <div class="result-value" id="summary-monthly-payment">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Monatlicher Cashflow nach Steuern</div>
                            <div class="result-value" id="summary-monthly-cashflow">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Immobilienwert nach Betrachtungszeitraum</div>
                            <div class="result-value" id="summary-final-value">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Restschuld nach Betrachtungszeitraum</div>
                            <div class="result-value" id="summary-remaining-debt">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Eigenkapitalentwicklung</div>
                            <div class="result-value" id="summary-equity-growth">0 €</div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">Gesamtrendite p.a. (inkl. Wertsteigerung)</div>
                            <div class="result-value" id="summary-total-roi">0 %</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab 3: Cashflow (bleibt wie zuvor) -->
        <div id="cashflow" class="tab-content">
            <div class="card">
                <h2>Cashflow-Analyse</h2>
                <div class="results" id="cashflow-results">
                    <div class="result-item">
                        <div class="result-label">Jährliche Mieteinnahmen (nach Leerstand)</div>
                        <div class="result-value" id="result-cf-annual-rent">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Jährliche Bewirtschaftungskosten</div>
                        <div class="result-value" id="result-cf-ongoing-costs">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Jährliche Finanzierungskosten</div>
                        <div class="result-value" id="result-cf-financing">0 €</div>
                    </div>
                    
                    <!-- Erweiterter Abschreibungsbereich -->
                    <div class="depreciation-breakdown">
                        <div class="depreciation-item">
                            <div>Gebäudeabschreibung (AfA)</div>
                            <div id="result-cf-building-depreciation">0 €</div>
                        </div>
                        <div class="depreciation-item">
                            <div>Abschreibung Möbel</div>
                            <div id="result-cf-furniture-depreciation">0 €</div>
                        </div>
                        <div class="depreciation-item">
                            <div>Jährlicher Erhaltungsaufwand</div>
                            <div id="result-cf-maintenance-deduction">0 €</div>
                        </div>
                        <div class="depreciation-item" id="broker-consulting-item" style="display: none;">
                            <div>Maklerkosten als Beratungsleistung</div>
                            <div id="result-cf-broker-consulting">0 €</div>
                        </div>
                        <div class="depreciation-item depreciation-total">
                            <div>Gesamte steuerliche Abschreibung</div>
                            <div id="result-cf-total-depreciation">0 €</div>
                        </div>
                    </div>
                    
                    <!-- Verbesserte Steuerberechnung -->
                    <div class="result-item">
                        <div class="result-label">Zu versteuerndes Einkommen aus Immobilie</div>
                        <div class="result-value" id="result-cf-taxable-income">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Vorheriges zu versteuerndes Einkommen</div>
                        <div class="result-value" id="result-cf-previous-income">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Neues zu versteuerndes Gesamteinkommen</div>
                        <div class="result-value" id="result-cf-total-income">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Vorherige Einkommensteuer</div>
                        <div class="result-value" id="result-cf-previous-tax">0 €</div>
                    </div>
                    <div class="result-item" id="church-tax-container" style="display: none;">
                        <div class="result-label">Kirchensteuer (vorher)</div>
                        <div class="result-value" id="result-cf-previous-church-tax">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Einkommensteuer (nach Immobilie)</div>
                        <div class="result-value" id="result-cf-income-tax">0 €</div>
                    </div>
                    <div class="result-item" id="church-tax-new-container" style="display: none;">
                        <div class="result-label">Kirchensteuer (nach Immobilie)</div>
                        <div class="result-value" id="result-cf-new-church-tax">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Steuerersparnis durch Immobilie</div>
                        <div class="result-value" id="result-cf-tax-savings">0 €</div>
                    </div>
                    <div class="result-item" id="church-tax-savings-container" style="display: none;">
                        <div class="result-label">Kirchensteuer-Ersparnis</div>
                        <div class="result-value" id="result-cf-church-tax-savings">0 €</div>
                    </div>
                    
                    <!-- Cashflow-Ergebnisse -->
                    <div class="result-item">
                        <div class="result-label">Jährlicher Cashflow nach Steuern</div>
                        <div class="result-value" id="result-cf-after-tax">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Monatlicher Cashflow nach Steuern</div>
                        <div class="result-value" id="result-cf-monthly">0 €</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">Cashflow-Rendite (bezogen auf Eigenkapital)</div>
                        <div class="result-value" id="result-cf-roi">0 %</div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <canvas id="cashflowChart"></canvas>
                </div>
            </div>
        </div>
        <!-- Tab 4: Jahrestabelle (bleibt wie zuvor) -->
        <div id="yeartable" class="tab-content">
            <div class="card">
                <h2>Jahresübersicht</h2>
                <p>Detaillierte Übersicht aller Werte im Betrachtungszeitraum. <span class="tooltip" style="display: inline;">?<span class="tooltiptext">Klicke auf eine Kategorie, um detaillierte Informationen anzuzeigen.</span></span></p>
                
                <div class="table-container" style="overflow-x: auto; margin-top: 20px;">
                    <table id="year-details-table" class="year-table horizontal-year-table">
                        <thead>
                            <tr>
                                <th class="category-column">Kategorie</th>
                                <!-- Wird durch JavaScript mit Jahren gefüllt -->
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Hauptzeilen mit aufklappbaren Details -->
                            
                            <!-- 1. Einnahmen -->
                            <tr class="main-row" data-category="income">
                                <td class="category-cell"><span class="expand-indicator">&#9658;</span> Mieteinnahmen</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="income">
                                <td class="detail-label">Mieteinnahmen (brutto)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="income">
                                <td class="detail-label">Leerstand</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="income">
                                <td class="detail-label">Effektive Mieteinnahmen</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 2. Kosten -->
                            <tr class="main-row" data-category="costs">
                                <td class="category-cell"><span class="expand-indicator">&#9658;</span> Bewirtschaftungskosten</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="costs">
                                <td class="detail-label">Grundsteuer</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="costs">
                                <td class="detail-label">Hausverwaltung</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="costs">
                                <td class="detail-label">Instandhaltungsrücklage</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="costs">
                                <td class="detail-label">Versicherungen</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="costs">
                                <td class="detail-label">Gesamte Bewirtschaftungskosten</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 3. Cashflow vor Finanzierung -->
                            <tr class="main-row" data-category="cf-before-financing">
                                <td class="category-cell">Cashflow vor Finanzierung</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <!-- 4. Finanzierung -->
                            <tr class="main-row" data-category="financing">
                                <td class="category-cell"><span class="expand-indicator">&#9658;</span> Finanzierung</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="financing">
                                <td class="detail-label">Zinsanteil</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="financing">
                                <td class="detail-label">Tilgungsanteil</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="financing">
                                <td class="detail-label">Annuität (Rate)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 5. Cashflow vor Steuern -->
                            <tr class="main-row" data-category="cf-before-tax">
                                <td class="category-cell">Cashflow vor Steuern</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 6. Abschreibungen und Steuern -->
                            <tr class="main-row" data-category="tax">
                                <td class="category-cell"><span class="expand-indicator">&#9658;</span> Abschreibungen & Steuern</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">AfA Gebäude</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">AfA Möbel</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Erhaltungsaufwand</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax" data-broker-consulting="true" style="display: none;">
                                <td class="detail-label">Maklerkosten als Beratungsleistung</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Ergebnis vor Steuern</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Zu versteuerndes Einkommen (vorher)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Neues zu versteuerndes Gesamteinkommen</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Einkommensteuer (vorher)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax">
                                <td class="detail-label">Einkommensteuer (nachher)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="tax" data-church-tax="true">
                                <td class="detail-label">Kirchensteuer (vorher)</td>
                            </tr>
                            <tr class="detail-row" data-category="tax" data-church-tax="true">
                                <td class="detail-label">Kirchensteuer (nachher)</td>
                            </tr>
                            <!-- 7. Steuerersparnis -->
                            <tr class="main-row" data-category="tax-savings">
                                <td class="category-cell">Steuerersparnis</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 8. Cashflow nach Steuern -->
                            <tr class="main-row" data-category="cf-after-tax">
                                <td class="category-cell">Cashflow nach Steuern</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            
                            <!-- 9. Vermögenswerte -->
                            <tr class="main-row" data-category="assets">
                                <td class="category-cell"><span class="expand-indicator">&#9658;</span> Vermögenswerte</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="assets">
                                <td class="detail-label">Immobilienwert</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="assets">
                                <td class="detail-label">Restschuld</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="assets">
                                <td class="detail-label">Eigenkapital</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                            <tr class="detail-row" data-category="assets">
                                <td class="detail-label">Eigenkapitalrendite (bezogen auf Anfangsinvestition)</td>
                                <!-- Wird durch JavaScript mit Werten gefüllt -->
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 15px;">
                    <button id="export-table" style="margin-left: 10px; background-color: #27ae60;">Als CSV exportieren</button>
                    <button id="expand-all" style="margin-left: 10px; background-color: #f39c12;">Alle aufklappen</button>
                    <button id="collapse-all" style="margin-left: 10px; background-color: #e74c3c;">Alle zuklappen</button>
                </div>
            </div>
        </div>
        <!-- Neuer Tab: Steuerinformationen -->
        <div id="tax" class="tab-content">
            <div class="card">
                <h2>Persönliche Steuerinformationen</h2>
                <div class="form-group">
                    <label for="tax-status">Persönliche Verhältnisse</label>
                    <select id="tax-status">
                        <option value="single">Alleinstehend</option>
                        <option value="married">Verheiratet (Splitting-Verfahren)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="annual-income">Zu versteuerndes Brutto-Jahreseinkommen (€)
                        <span class="tooltip">?
                            <span class="tooltiptext">Ihr zu versteuerndes Brutto-Jahreseinkommen ohne die Immobilieneinkünfte</span>
                        </span>
                    </label>
                    <input type="number" id="annual-income" value="70000">
                </div>
                <div class="form-group">
                    <label for="church-tax">Kirchensteuer
                        <span class="tooltip">?
                            <span class="tooltiptext">Kirchensteuerpflichtig ja/nein</span>
                        </span>
                    </label>
                    <select id="church-tax">
                        <option value="no">Nein</option>
                        <option value="yes">Ja</option>
                    </select>
                </div>
                <div class="form-group" id="church-tax-rate-container" style="display: none;">
                    <label for="church-tax-rate">Kirchensteuersatz (%)
                        <span class="tooltip">?
                            <span class="tooltiptext">8% in Bayern und Baden-Württemberg, 9% in anderen Bundesländern</span>
                        </span>
                    </label>
                    <select id="church-tax-rate">
                        <option value="8">8%</option>
                        <option value="9" selected>9%</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tax-rate">Errechneter Steuersatz (%)
                        <span class="tooltip">?
                            <span class="tooltiptext">Wird basierend auf Ihrem Einkommen automatisch berechnet</span>
                        </span>
                    </label>
                    <input type="number" id="tax-rate" step="0.1" value="42.0" disabled>
                </div>
            </div>
            
            <!-- Berechnen-Button für Steuerinfo -->
            <div class="card calculation-button-container">
                <button id="calculate-tax" class="primary-button">Steuerinformationen aktualisieren</button>
            </div>
        </div>
    </div>

    <!-- JavaScript einbinden -->
    <script type="module" src="main.js"></script>
</body>
</html>